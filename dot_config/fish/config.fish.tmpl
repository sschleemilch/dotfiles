function add_to_fish_user_paths_if_exists
    for dir in $argv
        if test -d $dir
            set -Ua fish_user_paths $dir
        end
    end
end
 
add_to_fish_user_paths_if_exists $HOME/.local/bin $HOME/go/bin /usr/local/bin/ $HOME/.local/share/bob/nvim-bin
 
{{ if eq .chezmoi.os "darwin" }}
add_to_fish_user_paths_if_exists /opt/homebrew/bin
set -x SHELL /opt/homebrew/bin/fish
{{ end }}


function prepend_to_sys_path_if_exists
    for dir in $argv
        if test -d $dir
            set -gx PATH $dir $PATH
        end
    end
end

{{- if eq .chezmoi.hostname "LPTP2048124" }}
prepend_to_sys_path_if_exists /opt/homebrew/opt/python@3.12/libexec/bin
prepend_to_sys_path_if_exists /opt/homebrew/opt/openjdk@21/bin
add_to_fish_user_paths_if_exists $HOME/Library/Android/sdk/platform-tools
set -x http_proxy 127.0.0.1:3128
set -x https_proxy 127.0.0.1:3128
set -x GOPRIVATE 'atc-github.azure.cloud.bmw/*'
{{- end }}


set -x EDITOR nvim
set -x VISUAL nvim
set -x MANPAGER 'nvim +Man!'

set -x K9S_CONFIG_DIR ~/.config/k9s
set -x RIPGREP_CONFIG_PATH ~/.config/ripgreprc

set -U fish_greeting

if status is-interactive
  fish_vi_key_bindings
  function starship_transient_prompt_func
    starship module character
  end
  starship init fish | source
  enable_transience
  zoxide init fish | source
  fzf --fish | source
  direnv hook fish | source

  # Aliases
  abbr -a g git
  abbr -a la eza -a
  abbr -a ll eza -l
  abbr -a lla eza -la
  abbr -a ls eza
  abbr -a lt eza --tree
  abbr -a tree eza --tree
  abbr -a v nvim
  abbr -a gg lazygit
  abbr -a cm chezmoi
{{- if eq .chezmoi.os "linux" }}
  abbr -a hypr 'if uwsm check may-start; exec uwsm start hyprland.desktop; end'
  abbr -a hx helix
{{- end }}
end

{{ if eq .colorscheme "rose-pine" -}}
set -l COLORS "--color=fg:#908caa,bg:#191724,hl:#ebbcba
	--color=fg+:#e0def4,bg+:#26233a,hl+:#ebbcba
 	--color=border:#908caa,header:#31748f,gutter:#191724
 	--color=spinner:#f6c177,info:#9ccfd8
 	--color=pointer:#c4a7e7,marker:#eb6f92,prompt:#908caa"
fish_config theme choose "rose_pine"
{{- end -}}
{{ if eq .colorscheme "rose-pine-dawn" -}}
set -l COLORS "--color=fg:#797593,bg:#faf4ed,hl:#d7827e
	--color=fg+:#575279,bg+:#f2e9e1,hl+:#d7827e
	--color=border:#dfdad9,header:#286983,gutter:#faf4ed
	--color=spinner:#ea9d34,info:#56949f
	--color=pointer:#907aa9,marker:#b4637a,prompt:#797593"
fish_config theme choose "rose_pine_dawn"
{{- end -}}
{{ if eq .colorscheme "rose-pine-moon" -}}
set -l COLORS "--color=fg:#908caa,bg:#232136,hl:#ea9a97
	--color=fg+:#e0def4,bg+:#393552,hl+:#ea9a97
	--color=border:#44415a,header:#3e8fb0,gutter:#232136
	--color=spinner:#f6c177,info:#9ccfd8
	--color=pointer:#c4a7e7,marker:#eb6f92,prompt:#908caa"
fish_config theme choose "rose_pine_moon"
{{- end -}}
{{- if eq .colorscheme "tokyonight-night" -}}
set -l COLORS "--color=bg+:#283457 \
  --color=bg:#1a1b26 \
  --color=border:#565f89 \
  --color=fg:#c0caf5 \
  --color=gutter:#1a1b26 \
  --color=header:#ff9e64 \
  --color=hl+:#2ac3de \
  --color=hl:#2ac3de \
  --color=info:#545c7e \
  --color=marker:#ff007c \
  --color=pointer:#ff007c \
  --color=prompt:#2ac3de \
  --color=query:#c0caf5:regular \
  --color=scrollbar:#27a1b9 \
  --color=separator:#ff9e64 \
  --color=spinner:#ff007c"
fish_config theme choose "tokyonight-night"
{{- end -}}
{{- if eq .colorscheme "kanagawa" -}}
set -l COLORS "--color=fg:#c8c093,fg+:#c8c093,bg:#1f1f28,bg+:#223249
  --color=hl:#7e9cd8,hl+:#7e9cd8,info:#c8c093,marker:#ff9e3b
  --color=prompt:#7e9cd8,spinner:#ff9e3b,pointer:#ff9e3b,header:#6a9589
  --color=gutter:#1f1f28,border:#727169,separator:#54546d,label:#aeaeae
  --color=query:#7e9cd8"
{{- end -}}
{{- if eq .colorscheme "techbase" -}}
set -l COLORS "--color=gutter:-1,bg+:#121e42,pointer:#1a8c9b,info:#474b65,hl:#1a8c9b,hl+:#1a8c9b,prompt:#1a8c9b"
{{- end -}}
{{- if eq .colorscheme "vague" -}}
set -l COLORS "--color=hl:#f3be7c
    --color=bg:-1
    --color=gutter:-1
    --color=bg+:#252530
    --color=fg+:#aeaed1
    --color=hl+:#f3be7c
    --color=border:#606079
    --color=prompt:#bb9dbd
    --color=query:#aeaed1:bold
    --color=pointer:#aeaed1
    --color=scrollbar:#aeaed1
    --color=info:#f3be7c
    --color=spinner:#7fa563"
{{- end -}}
{{- if eq .colorscheme "carbonfox" -}}

set -l COLORS "--color=gutter:#2a2a2a,bg+:#2a2a2a,pointer:#3ddbd9,info:#8cb6ff,hl:#3ddbd9,hl+:#3ddbd9"

set -l foreground f2f4f8
set -l selection 2a2a2a
set -l comment 6e6f70
set -l red ee5396
set -l orange 3ddbd9
set -l yellow 08bdba
set -l green 25be6a
set -l purple be95ff
set -l cyan 33b1ff
set -l pink ff7eb6

# Syntax Highlighting Colors
set -g fish_color_normal $foreground
set -g fish_color_command $cyan
set -g fish_color_keyword $pink
set -g fish_color_quote $yellow
set -g fish_color_redirection $foreground
set -g fish_color_end $orange
set -g fish_color_error $red
set -g fish_color_param $purple
set -g fish_color_comment $comment
set -g fish_color_selection --background=$selection
set -g fish_color_search_match --background=$selection
set -g fish_color_operator $green
set -g fish_color_escape $pink
set -g fish_color_autosuggestion $comment

# Completion Pager Colors
set -g fish_pager_color_progress $comment
set -g fish_pager_color_prefix $cyan
set -g fish_pager_color_completion $foreground
set -g fish_pager_color_description $comment
{{- end -}}
{{- if eq .colorscheme "catppuccin-mocha" -}}
set -l COLORS "--color=bg+:#313244,bg:#1e1e2e,spinner:#F5E0DC,hl:#F38BA8 \
  --color=fg:#CDD6F4,header:#F38BA8,info:#CBA6F7,pointer:#F5E0DC \
  --color=marker:#B4BEFE,fg+:#CDD6F4,prompt:#CBA6F7,hl+:#F38BA8 \
  --color=selected-bg:#45475A,gutter:#1e1e2e \
  --color=border:#9399b2,label:#CDD6F4"
fish_config theme choose "catppuccin_mocha"
{{- end }}

set -x FZF_DEFAULT_OPTS "
    --highlight-line
    --info=inline-right
    --wrap
    --tmux 60%,70%
    --ansi
    --border=sharp
    --layout=reverse
    $COLORS"

set -x _ZO_FZF_OPTS $FZF_DEFAULT_OPTS
